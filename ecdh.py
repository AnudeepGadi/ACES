from tinyec import registry
from tinyec.registry import ec
import secrets

def compress(pubKey):
    return hex(pubKey.x) + hex(pubKey.y)


def decompress(compressed):
    keys = compressed.split('0x')
    return ec.Point(registry.get_curve('secp521r1'),int(keys[1],16),int(keys[2],16))


curve = registry.get_curve('secp521r1')

studentPrivKey = int("2234710815580100598068262070354228503458003591313073249326726136470361345449378262543143321821931545292962712181273786408585614281225244188673182077927108249")
studentPubKey = studentPrivKey * curve.g
studentPubKey=decompress("0x1e1302fa9036ebb998b976ce3e3b65f70a505b984a05d6784d72d51ec6064c25739aef74beebe422786bebaed15f503f24504a3199f70d0695b37f1e98ddcb215fa0xaf8dc2077fcd86e4d1ece20a186883fb9cebe631b23865e06c487868b8ba02ea0e735a54e3fd474faa64b1261dfbe8ff2b241190e966ad22c6087a27cbab9c6138")

verifierPrivKey = int("6237954253193960250965894978122480089938507494586503100375045968489646408446266818991527214774037264715389789050671722053688366222884689177002421130867220902")
verifierPubKey=decompress("0x1cccb77dee827fcd9501a87be21bdad8fae2e81c97a749ac0e06c3bf020a140b31dd69f8300bd9d5b2c7ff657ac11cc92d7c71e1dd88e4597a88fab3ce94916e2880x1bc152265e52bcec718921c33c4258cbb8071d189b5d184a19c768564fb275188902aa331fdbc3530e2926c3854f044545a3e172c902fd8f315c769a627e7da4ea9")

studentSharedKey = studentPrivKey * verifierPubKey
verifierSharedKey = verifierPrivKey * studentPubKey
print("Student shared key:", compress(studentSharedKey))
print("Verifier shared key:", compress(verifierSharedKey))
print(studentSharedKey == verifierSharedKey)




'''
acd976f84ff02ae1925d5d702f39cecb8865f54b63c7795bbf30e4415406123732f665157849b0d284dd9ca445ca236179a76aee76b45dcf783dedc774c93581741e9c6d416e49b952a74dc106f94d0eb7dbb9c14d2efb44b096ffb09d3cd82823304218ee3b6346e7faa704e04932883c41948eeae495aec92644a6a1b89402f9574

STUDENT_PRIVATE_KEY=6414351394054703668689273485847386094616555433648916434978510272497513953802341816200499608193340464608664894620138044778262643036477894817687518593119038645
STUDENT_PUBLIC_KEY=1173dd733edd82b38a4f10311f3d4f8a7aa3d007925da8c8b007ad583d4442e69a815bd76720da9dc14c8e1d04c856dc1076429455cf6fc3747a5718dbded4539584d32d53e53fc7e578bbecc343e8855814b3eb6e2f28d40e368742452476c081fec5c0d85d4b804f9640f30ea47f684f23dd088abf485d9aa06945940bf20af27e8

VERIFIER_PRIVATE_KEY=4949385240134024856314232476111114400528223173157160312970240764395107424383419861383428995280641559816764232787736489852140447723736077506146183535304081963
VERIFIER_PUBLIC_KEY=af77fadb591dd69685024eeb168f15a1a09a55c1d150c515097784e95593ae3359f281de89ffdb5572ffd8623e7b405e5bd678c95ecbf42a29abb33d18908386701d61451c49a00b76a697c5d92eb32ba0ea224cef2459a1d4d3e8275c1cd25cfc15f3dbd5e68bf42bd190567ba079bd5191576aeee4dae7b13b8f5985e14826d837
'''